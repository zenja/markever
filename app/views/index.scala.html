<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Markever</title>

    <link rel="stylesheet" media="screen" href='@routes.Assets.at("/public/stylesheets", "bootstrap.min.css")'>
    <link rel="stylesheet" media="screen" href='@routes.Assets.at("/public/stylesheets", "railscasts.css")'>
    <link rel="stylesheet" media="screen" href='@routes.Assets.at("/public/stylesheets", "main.css")'>
    <link rel="shortcut icon" type="image/png" href='@routes.Assets.at("/public/images", "favicon.ico")'>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
            showMathMenu: false
        });
    </script>
    <!-- TODO: host the MathJax resources locally -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body ng-app="markever" ng-controller="EditorController as main">
    <!-- Toolbar -->
    <div id="toolbar">
        <img id="toolbar_logo" src='@routes.Assets.at("/public/images", "logo.png")' alt="logo" />
        <!-- H button -->
        <button class="btn btn-toolbar" ng-click='main.open_settings_modal()'>
            <span class="glyphicon glyphicon-header" aria-hidden="true"></span>
        </button>
        <!-- Save button -->
        <button class="btn btn-toolbar" ng-click="main.save_note()" ng-disabled="main.saving_note">
            <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
        </button>
        <!-- Notes button -->
        <div class="btn-group" dropdown>
            <button class="btn btn-toolbar dropdown-toggle" dropdown-toggle ng-click="main.refresh_all_notes()">
                <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
                <li ng-repeat="note in main.all_notes">
                    <a href ng-click="main.load_note(note.guid)">{{note.title}}</a>
                </li>
            </ul>
        </div>
        <!-- Settings button -->
        <button class="btn btn-toolbar" ng-click="main.open_settings_modal()">
            <span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
        </button>
    </div>

    <!-- Editor and previewer area -->
    <div id="md_div" ng-paste='main.handle_paste($event)'>
        <div id="md_editor_div" ng-model="main.note.markdown" ng-change="main.md2html()" ui-ace="{
            useWrapMode : true,
            showGutter: false,
            mode: 'markdown',
            workerPath: '/javascripts/ace',
            onLoad: aceLoaded,
            onChange: aceChanged
        }"></div>
        <div id="md_html_div" ng-bind-html="main.htmlSafe"></div>
    </div>
    <div id="md_html_div_hidden" ng-bind-html="main.htmlSafe" style="visibility:hidden;height:1px;overflow:hidden;z-index:0;"></div>

    <!-- Loading Indicator Modal -->
    <div class="modal fade" id="loading-modal" tabindex="-1" role="dialog" aria-labelledby="settings-modal" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-body">
                    <p>Loading the note...</p>
                    <progressbar class="progress-striped active" value="100" type="success" />
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal fade" id="settings-modal" tabindex="-1" role="dialog" aria-labelledby="settings-modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Settings</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="keyboard_handler">Keyboard binding</label>
                        <select id="keyboard_handler" ng-model="main.new_keyboard_handler" ng-options="h.name for h in main.keyboard_handlers">
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ace_theme">Editor theme</label>
                        <select id="ace_theme" ng-model="main.new_ace_theme" ng-options="t.name for t in main.ace_themes">
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="show_gutter">Show line number</label>
                        <select id="show_gutter" ng-model="main.new_show_gutter"
                                ng-options="o.v as o.n for o in [{ n: 'No', v: false }, { n: 'Yes', v: true }]">
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" ng-click="main.save_settings()" data-dismiss="modal">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src='@routes.Assets.at("/public/javascripts", "jquery-1.11.0.min.js")' type="text/javascript"></script>
    <!-- TODO customize bootstrap js -->
    <script src='@routes.Assets.at("/public/javascripts", "bootstrap.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "marked.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "highlight.pack.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "jquery.htmlClean.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "jquery.inlineStyler.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "ace.min.js")' type="text/javascript"></script>
    <script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.3.8/angular.min.js' type="text/javascript"></script>
    <script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.3.8/angular-resource.min.js' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "angular-local-storage.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "ui-bootstrap-tpls-0.12.0.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "ui-ace.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "angular-uuid2.min.js")' type="text/javascript"></script>
    <script src='@routes.Assets.at("/public/javascripts", "app-ng.js")' type="text/javascript"></script>
</body>
</html>
